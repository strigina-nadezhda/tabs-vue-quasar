"use strict";(globalThis["webpackChunkquasar_project"]=globalThis["webpackChunkquasar_project"]||[]).push([[564],{8564:(e,l,s)=>{s.r(l),s.d(l,{default:()=>I});var t=s(9835),a=s(6970);const n={class:"editeForm"},o={class:"form-title q-ma-none text-bold q-mb-md"},i={class:"text-primary"},m={class:"row q-col-gutter-md"},r=(0,t._)("h6",{class:"q-ma-none text-bold q-my-md"},"Дополнительная информация:",-1),d={class:"row"},u={class:"col-xs-12 col-sm-6 col-md-6 q-col-gutter-y-md"},p={class:"self-end q-pt-md"},c={class:"text-subtitle2 text-right"},_={class:"text-subtitle2 text-right"};function h(e,l,s,h,y,b){const f=(0,t.up)("q-input"),V=(0,t.up)("q-select"),g=(0,t.up)("q-btn"),x=(0,t.up)("q-card-actions"),w=(0,t.up)("q-form");return(0,t.wg)(),(0,t.iD)("div",n,[(0,t._)("h6",o,[(0,t.Uk)(" Редактирование заявки "),(0,t._)("span",i," #"+(0,a.zw)(e.num),1)]),(0,t.Wm)(w,{onSubmit:e.onSubmit,onReset:l[11]||(l[11]=l=>e.onReset(e.$route.params.id)),class:"form"},{default:(0,t.w5)((()=>[(0,t._)("div",m,[(0,t.Wm)(f,{outlined:"",dense:"",modelValue:e.person_fullname,"onUpdate:modelValue":l[0]||(l[0]=l=>e.person_fullname=l),label:"Имя клиента *","lazy-rules":"",rules:e.rules,class:"col-xs-12 col-sm-6 col-md-6"},null,8,["modelValue","rules"]),(0,t.Wm)(f,{outlined:"",dense:"",modelValue:e.person_phone,"onUpdate:modelValue":l[1]||(l[1]=l=>e.person_phone=l),label:"Номер телефона *","lazy-rules":"",rules:e.rules,"fill-mask":"",mask:"7 (###) ### - ####",class:"col-xs-12 col-sm-6 col-md-6"},null,8,["modelValue","rules"]),(0,t.Wm)(f,{label:"E-mail *",modelValue:e.person_email,"onUpdate:modelValue":l[2]||(l[2]=l=>e.person_email=l),type:"email",outlined:"",dense:"","lazy-rules":"",rules:e.rules,class:"col-xs-12 col-sm-6 col-md-6"},null,8,["modelValue","rules"]),(0,t.Wm)(f,{label:"Название компании *",modelValue:e.company_name,"onUpdate:modelValue":l[3]||(l[3]=l=>e.company_name=l),outlined:"",dense:"","lazy-rules":"",rules:e.rules,class:"col-xs-12 col-sm-6 col-md-6"},null,8,["modelValue","rules"]),(0,t.Wm)(V,{modelValue:e.company_type,"onUpdate:modelValue":l[4]||(l[4]=l=>e.company_type=l),options:e.companyTypes,label:"Организационно-правовая форма *",outlined:"",dense:"",class:"col-xs-12 col-sm-6 col-md-6"},null,8,["modelValue","options"]),(0,t.Wm)(f,{outlined:"",dense:"",modelValue:e.inn,"onUpdate:modelValue":l[5]||(l[5]=l=>e.inn=l),label:"ИНН клиента*","lazy-rules":"",rules:e.rules,mask:"## ## ### ### ##",class:"col-xs-12 col-sm-6 col-md-6"},null,8,["modelValue","rules"]),(0,t.Wm)(V,{modelValue:e.stg,"onUpdate:modelValue":l[6]||(l[6]=l=>e.stg=l),multiple:"",options:e.products,label:"Продукт",outlined:"",dense:"",class:"col-xs-12 col-sm-6 col-md-6"},null,8,["modelValue","options"]),(0,t.Wm)(V,{modelValue:e.state,"onUpdate:modelValue":l[7]||(l[7]=l=>e.state=l),options:e.optionsState,label:"Статус заявки *",outlined:"",dense:"","lazy-rules":"",rules:e.rules,class:"col-xs-12 col-sm-6 col-md-6"},null,8,["modelValue","options","rules"])]),r,(0,t._)("div",d,[(0,t._)("div",u,[(0,t.Wm)(f,{outlined:"",dense:"",modelValue:e.client_name,"onUpdate:modelValue":l[8]||(l[8]=l=>e.client_name=l),label:"Партнёр","lazy-rules":""},null,8,["modelValue"]),(0,t.Wm)(f,{outlined:"",dense:"",modelValue:e.partnerInn,"onUpdate:modelValue":l[9]||(l[9]=l=>e.partnerInn=l),label:"ИНН партнёра","lazy-rules":"",mask:"## ## ### ### ##"},null,8,["modelValue"]),(0,t.Wm)(f,{outlined:"",dense:"",modelValue:e.crm_source_type,"onUpdate:modelValue":l[10]||(l[10]=l=>e.crm_source_type=l),label:"Источник заявки","lazy-rules":""},null,8,["modelValue"])])]),(0,t._)("div",p,[(0,t._)("div",c," Заявка принята "+(0,a.zw)(e.formatDateTime(e.dadd))+" в "+(0,a.zw)(e.formatDateOnlyTime(e.dadd))+". ",1),(0,t._)("div",_," Последнее обновление "+(0,a.zw)(e.formatDateTime(e.lastUpd))+" в "+(0,a.zw)(e.formatDateOnlyTime(e.lastUpd))+". ",1)]),(0,t.Wm)(x,{class:"form-actions q-px-none"},{default:(0,t.w5)((()=>[(0,t.Wm)(g,{label:"Сохранить",color:"primary",type:"submit"}),(0,t.Wm)(g,{label:"Отмена",type:"reset",color:"primary",flat:"",class:"q-ml-sm"})])),_:1})])),_:1},8,["onSubmit"])])}var y=s(3100),b=s(499),f=s(4376),V=s(9302);const{formatDate:g}=f["default"],x=(0,t.aZ)({name:"OrderForm",setup(){const e=(0,V.Z)();return{num:(0,b.iH)(null),id:(0,b.iH)(null),dadd:(0,b.iH)(null),profile_id:(0,b.iH)(null),state:(0,b.iH)(null),stg:(0,b.iH)([]),inn:(0,b.iH)(null),company_name:(0,b.iH)(null),person_phone:(0,b.iH)(null),company_type:(0,b.iH)(null),person_email:(0,b.iH)(null),lastUpd:new Date,person_fullname:(0,b.iH)(null),is_new:(0,b.iH)(null),type:(0,b.iH)("partner"),user_id:(0,b.iH)(null),client_name:(0,b.iH)(null),partnerInn:(0,b.iH)(null),crm_source_type:(0,b.iH)(null),rules:[e=>!!e||"Обязательное поле!"],showNotif(){e.notify({message:"Изменения успешно сохранены",color:"primary",type:"positive"})},showLoading(){e.loading.show({message:"Загрузка..."})},hideLoading(){e.loading.hide()}}},methods:{...(0,y.OI)({editOrder:"allTabs/editOrder"}),...(0,y.nv)({getOrderData:"allTabs/getOrderData"}),onSubmit(){const e={id:this.id,num:this.num,dadd:this.dadd,profile_id:this.profile_id,state:this.state,lastUpd:new Date,stg:Array.from(this.stg),inn:this.inn,company_name:this.company_name,person_phone:this.person_phone,company_type:this.company_type,person_fullname:this.person_fullname,person_email:this.person_email,extra:{partner:{type:this.type,user_id:this.user_id,client_name:this.client_name,inn:this.partnerInn},crm_source_type:this.crm_source_type},is_new:!0},l=this.orderIndex(e.id);this.editOrder({index:l,form:e}),this.showNotif(),console.log("edit tab",e)},onReset(e){this.$emit("close",{id:e})},updateForm(e){this.profile_id=e.profile_id,this.num=e.num,this.stg=e.stg,this.inn=e.inn,this.partnerInn=e.extra?.partner?.inn,this.crm_source_type=e.extra?.crm_source_type,this.company_name=e.company_name,this.company_type=e.company_type,this.person_email=e.person_email,this.dadd=e.dadd,this.client_name=e.extra?.partner?.client_name,this.state=e.state,this.person_fullname=e.person_fullname,this.person_phone=e.person_phone,this.id=e.id,this.lastUpd=e.lastUpd,this.user_id=e.user_id,this.is_new=e.is_new},formatDateOnlyTime(e){return g(e,"HH:mm")},formatDateTime(e){return g(e,"DD.MM.YYYY")}},watch:{tabForm(e){e&&this.updateForm(e)}},computed:{...(0,y.rn)({optionsState:e=>e.allTabs.optionsState,products:e=>e.allTabs.products,companyTypes:e=>e.allTabs.companyTypes}),...(0,y.Se)({tabForm:"allTabs/tabForm",orderIndex:"allTabs/orderIndex"}),tabId(){return this.$route.params.id}},mounted(){this.showLoading(),this.getOrderData(this.tabId).then((()=>this.hideLoading()))}});var w=s(1639),H=s(8326),T=s(6611),U=s(7509),q=s(1821),D=s(4455),W=s(9984),z=s.n(W);const v=(0,w.Z)(x,[["render",h]]),I=v;z()(x,"components",{QForm:H.Z,QInput:T.Z,QSelect:U.Z,QCardActions:q.Z,QBtn:D.Z})}}]);